<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
* { margin: 0; padding: 0; }
#sortable { list-style-type: none; margin: 0; padding: 0;}
#constant {
    position: fixed;
    width: 100%;
    background-color: #ccc;
    height: 75px;
}
.right {
    float: right;
    padding-top: 20px;
    padding-right: 10px;
}
#tweet {
    padding-top: 23px;
}
h1 {
    color: #eee;
    font-size:60px;
    font-variant:small-caps;
    font-family:Helvetica, Arial, sans-serif;
    padding-left: 20px;
    float: left;
}
#photos {
   /* Prevent vertical gaps */
   line-height: 0;
   -webkit-column-count: 5;
   -webkit-column-gap:   0px;
   -moz-column-count:    5;
   -moz-column-gap:      0px;
   column-count:         5;
   column-gap:           0px;

}
#photos img {
  /* Just in case there are inline attributes */
  width: 100% !important;
  height: auto !important;
}

@media (max-width: 1200px) {
  #photos {
  -moz-column-count:    4;
  -webkit-column-count: 4;
  column-count:         4;
  }
}
@media (max-width: 1000px) {
  #photos {
  -moz-column-count:    3;
  -webkit-column-count: 3;
  column-count:         3;
  }
}
@media (max-width: 800px) {
  #photos {
  -moz-column-count:    2;
  -webkit-column-count: 2;
  column-count:         2;
  }
}
@media (max-width: 400px) {
  #photos {
  -moz-column-count:    1;
  -webkit-column-count: 1;
  column-count:         1;
  }
}
    </style>
    <script src="http://connect.facebook.net/en_US/all.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"></script>
    <script type="text/javascript">
function buildMosaic(response) {
    FB.api(
      {
          'method': 'fql.query',
          'query': "SELECT uid, name, pic_big FROM user WHERE uid =" + response.session.uid +" OR uid IN (SELECT uid2 FROM friend WHERE uid1 ="+ response.session.uid +")"
      },
      function(response) {
          var photos = [];
          photos.push('<ul id="sortable">');
          $.each(response.data, function(index, item) {
              photos.push('<li class="ui-state-default"><img src="'+item['pic_big']+'"></li>');
          });
          photos.push("</ul>");
          $("#photos").html(p_array.join(''));
          $("#sortable").sortable({ handle: 'img' });
          $("#sortable").disableSelection();
      }
    );
}

$(document).ready(function() {
    FB.init({
        "appId"  : '153403654734305',
        "status" : true, // check login status
        "cookie" : true, // enable cookies to allow the server to access the session
        "xfbml"  : true
    });
    FB.Event.subscribe('auth.login', buildMosaic);
    FB.Event.subscribe('auth.logout', buildMosaic);
    FB.getLoginStatus(buildMosaic);
});
    </script>
</head>
<body>
    <div id="fb-root"></div>
    <div id="constant">
        <h1>Mosaic Machine</h1>
        <fb:login-button perms="user_photos,friends_photos,user_photo_video_tags,friends_photo_video_tags" onlogin="buildMosaic()">See Your Mosaic</fb:login-button>
        <div class="right">
            <fb:like href="http://www.mosaicmachine.com" send="true" width="450" show_faces="true" font=""></fb:like>
        </div>
        <div class="right" id="tweet">
            <a href="http://twitter.com/share" class="twitter-share-button" data-url="mosaicmachine.com" data-count="horizontal">Tweet</a>
            <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
        </div>
    </div>
<section id="photos">
</section>
</body>
</html>
